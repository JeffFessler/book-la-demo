<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>RMT and matrix completion · Demos</title><meta name="title" content="RMT and matrix completion · Demos"/><meta property="og:title" content="RMT and matrix completion · Demos"/><meta property="twitter:title" content="RMT and matrix completion · Demos"/><meta name="description" content="Documentation for Demos."/><meta property="og:description" content="Documentation for Demos."/><meta property="twitter:description" content="Documentation for Demos."/><meta property="og:url" content="https://JeffFessler.github.io/book-la-demo/stable/generated/demos/12/complete1/"/><meta property="twitter:url" content="https://JeffFessler.github.io/book-la-demo/stable/generated/demos/12/complete1/"/><link rel="canonical" href="https://JeffFessler.github.io/book-la-demo/stable/generated/demos/12/complete1/"/><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../search_index.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.png" alt="Demos logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">Demos</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">01 Tutorials</span><ul><li><a class="tocitem" href="../../01/1-intro/">Tutorial: Julia Overview</a></li><li><a class="tocitem" href="../../01/2-vector/">Tutorial: Vectors in Julia</a></li></ul></li><li><span class="tocitem">02 Matrix</span><ul><li><a class="tocitem" href="../../02/conv-mat/">Convolution matrix</a></li><li><a class="tocitem" href="../../02/dot/">Vector dot product</a></li><li><a class="tocitem" href="../../02/gauss2d/">2d heatmap</a></li><li><a class="tocitem" href="../../02/mul-mat-vec/">Matrix-vector product</a></li><li><a class="tocitem" href="../../02/outer/">Vector outer product</a></li></ul></li><li><span class="tocitem">04 Subspaces</span><ul><li><a class="tocitem" href="../../04/svd-diff/">SVD of finite differences</a></li></ul></li><li><span class="tocitem">05 LS</span><ul><li><a class="tocitem" href="../../05/frame-cycle/">Wavelet frame denoising</a></li><li><a class="tocitem" href="../../05/ls-cost1/">LS cost functions</a></li><li><a class="tocitem" href="../../05/ls-cv/">LS fitting with cross validation</a></li><li><a class="tocitem" href="../../05/ls-fit1/">LS fitting</a></li><li><a class="tocitem" href="../../05/ls-lift/">LS lifting</a></li><li><a class="tocitem" href="../../05/sat-regress/">Linear regression and SAT scores</a></li></ul></li><li><span class="tocitem">06 Norm</span><ul><li><a class="tocitem" href="../../06/procrustes/">Procrustes method</a></li><li><a class="tocitem" href="../../06/robust-regress/">Robust regression</a></li></ul></li><li><span class="tocitem">07 Low-Rank</span><ul><li><a class="tocitem" href="../../07/lr-cv/">Low-Rank Selection via Cross Validation</a></li><li><a class="tocitem" href="../../07/lr-sure/">Low-Rank SURE</a></li><li><a class="tocitem" href="../../07/pca/">PCA</a></li><li><a class="tocitem" href="../../07/photometric3/">Photometric stereo</a></li><li><a class="tocitem" href="../../07/rank1/">Rank-1 approximation</a></li><li><a class="tocitem" href="../../07/source-local/">Source localization</a></li></ul></li><li><span class="tocitem">08 Special</span><ul><li><a class="tocitem" href="../../08/eigmap/">Laplacian eigenmaps</a></li><li><a class="tocitem" href="../../08/kron-sum-inv/">Kronecker sum of circulant</a></li><li><a class="tocitem" href="../../08/spectral-cluster/">Spectral clustering</a></li><li><a class="tocitem" href="../../08/ssc/">Sparse spectral clustering (SSC)</a></li></ul></li><li><span class="tocitem">09 Optimize</span><ul><li><a class="tocitem" href="../../09/class01/">Binary classification</a></li><li><a class="tocitem" href="../../09/logistic1/">Logistic regression</a></li><li><a class="tocitem" href="../../09/precon1/">Preconditioning</a></li></ul></li><li><span class="tocitem">10 Complete</span><ul><li><a class="tocitem" href="../../10/foreback/">Video foreground/background separation</a></li><li><a class="tocitem" href="../../10/lrmc-m/">Low-rank matrix completion: AltMin, ISTA, FISTA</a></li><li><a class="tocitem" href="../../10/lrmc3/">Low-rank matrix completion: ADMM</a></li><li><a class="tocitem" href="../../10/nmf/">Non-negative matrix factorization</a></li></ul></li><li><span class="tocitem">11 Neural nets</span><ul><li><a class="tocitem" href="../../11/ring3/">Classification with MLP</a></li></ul></li><li><span class="tocitem">12 RMT</span><ul><li class="is-active"><a class="tocitem" href>RMT and matrix completion</a><ul class="internal"><li><a class="tocitem" href="#Helper-functions"><span>Helper functions</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li><li><a class="tocitem" href="#Image-example"><span>Image example</span></a></li><li><a class="tocitem" href="#Latent-matrix"><span>Latent matrix</span></a></li><li><a class="tocitem" href="#Noisy-/-incomplete-data"><span>Noisy / incomplete data</span></a></li><li><a class="tocitem" href="#Singular-values."><span>Singular values.</span></a></li><li><a class="tocitem" href="#Low-rank-estimate"><span>Low-rank estimate</span></a></li></ul></li><li><a class="tocitem" href="../gauss1/">Random matrix theory and rank-1 signal + noise</a></li><li><a class="tocitem" href="../outlier1/">RMT and outliers</a></li><li><a class="tocitem" href="../round1/">Roundoff errors and rank</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">12 RMT</a></li><li class="is-active"><a href>RMT and matrix completion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>RMT and matrix completion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JeffFessler/book-la-demo" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JeffFessler/book-la-demo/blob/main/docs/lit/demos/12/complete1.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="rmt-complete1"><a class="docs-heading-anchor" href="#rmt-complete1">RMT and matrix completion</a><a id="rmt-complete1-1"></a><a class="docs-heading-anchor-permalink" href="#rmt-complete1" title="Permalink"></a></h1><p>This example examines noisy matrix completion (estimating a low-rank matrix from noisy data with missing measurements) through the lens of random matrix theory, using the Julia language.</p><p>This page comes from a single Julia file: <a href="https://github.com/JeffFessler/book-la-demo/blob/main/docs/lit/demos/12/complete1.jl"><code>complete1.jl</code></a>.</p><p>You can access the source code for such Julia documentation using the &#39;Edit on GitHub&#39; link in the top right. You can view the corresponding notebook in <a href="https://nbviewer.org/">nbviewer</a> here: <a href="https://nbviewer.org/github/JeffFessler/book-la-demo/tree/gh-pages/generated/demos/12/complete1.ipynb"><code>complete1.ipynb</code></a>, or open it in <a href="https://mybinder.org/">binder</a> here: <a href="https://mybinder.org/v2/gh/JeffFessler/book-la-demo/gh-pages?filepath=generated/demos/12/complete1.ipynb"><code>complete1.ipynb</code></a>.</p><p>Add the Julia packages that are need for this demo. Change <code>false</code> to <code>true</code> in the following code block if you are using any of the following packages for the first time.</p><pre><code class="language-julia hljs">if false
    import Pkg
    Pkg.add([
        &quot;InteractiveUtils&quot;
        &quot;LaTeXStrings&quot;
        &quot;LinearAlgebra&quot;
        &quot;MIRTjim&quot;
        &quot;Plots&quot;
        &quot;Random&quot;
        &quot;StatsBase&quot;
    ])
end</code></pre><p>Tell Julia to use the following packages for this example. Run <code>Pkg.add()</code> in the preceding code block first, if needed.</p><pre><code class="language-julia hljs">using InteractiveUtils: versioninfo
using LaTeXStrings
using LinearAlgebra: Diagonal, dot, norm, rank, svd, svdvals
using MIRTjim: prompt, jim
using Plots: default, gui, plot, plot!, scatter!, savefig
using Plots.PlotMeasures: px
using Random: seed!
using StatsBase: mean, var
default(markerstrokecolor=:auto, label=&quot;&quot;, widen=true, markersize = 6,
 labelfontsize = 24, legendfontsize = 18, tickfontsize = 14, linewidth = 3,
)
seed!(0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><p>The following line is helpful when running this file as a script; this way it will prompt user to hit a key after each image is displayed.</p><pre><code class="language-julia hljs">isinteractive() &amp;&amp; prompt(:prompt);</code></pre><h2 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h2><p>Generate random data for one trial:</p><pre><code class="language-julia hljs">function gen1(
    θ::Real = 3,
    M::Int = 100,
    N::Int = 2M,
    p_obs::Real = 1, # probability an element is observed
    T::Type{&lt;:Real} = Float32,
)
    mask = rand(M, N) .&lt;= p_obs
    u = rand((-1,+1), M) / T(sqrt(M)) # Bernoulli just for variety
    v = rand((-1,+1), N) / T(sqrt(N))
    # u = randn(T, M) / T(sqrt(M))
    # v = randn(T, N) / T(sqrt(N))
    X = θ * u * v&#39; # theoretically rank-1 matrix
    Z = randn(T, M, N) / T(sqrt(N)) # gaussian noise
    Y = mask .* (X + Z) # missing entries set to zero
    return Y, u, v, θ, p_obs
end;</code></pre><p>SVD results for 1 trial:</p><pre><code class="language-julia hljs">function trial1(args...)
    Y, u, v, θ, p_obs = gen1(args...)
    fac = svd(Y)
    σ1 = fac.S[1]
    u1 = fac.U[:,1]
    v1 = fac.Vt[1,:]
    return [σ1, abs2(dot(u1, u)), abs2(dot(v1, v))]
end;</code></pre><p>Average <code>nrep</code> trials:</p><pre><code class="language-julia hljs">trial2(nrep::Int, args...) = mean((_) -&gt; trial1(args...), 1:nrep);</code></pre><p>SVD for each of multiple trials, for different SNRs and matrix sizes:</p><pre><code class="language-julia hljs">if !@isdefined(vgrid)

    # Simulation parameters
    T = Float32
    p_obs = 0.49
    Mlist = [30, 300]
    θmax = 4
    nθ = θmax * 4 + 1
    nrep = 100
    θlist = T.(range(0, θmax, nθ));
    labels = map(n -&gt; latexstring(&quot;\$M = $n\$&quot;), Mlist)

    c = 0.7 # non-square matrix to test
    c4 = c^0.25
    tmp = ((θ, M) -&gt; trial2(nrep, θ, M, ceil(Int, M/c) #= N =#, p_obs)).(θlist, Mlist&#39;)
    σgrid = map(x -&gt; x[1], tmp)
    ugrid = map(x -&gt; x[2], tmp)
    vgrid = map(x -&gt; x[3], tmp)
end;</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p>Compare theory predictions and empirical results. There is again notable agreement between theory and empirical results here.</p><p>σ1 plot</p><pre><code class="language-julia hljs">colors = [:orange, :red]
θfine = range(0, 2θmax, 60θmax + 1)
θmod = θfine .* sqrt(p_obs) # key modification from RMT!
sbg(θ) = θ &gt; c4 ? sqrt((1 + θ^2) * (c + θ^2)) / θ : 1 + √(c)
stheory = sbg.(θmod) * sqrt(p_obs) # note modification!
bm = s -&gt; &quot;\\mathbf{\\mathit{$s}}&quot;
ylabel = latexstring(&quot;\$σ_1($(bm(:Y)))\$ (Avg)&quot;)
ps = plot(θfine, stheory, color=:blue, label=&quot;theory&quot;,
    aspect_ratio = 1, legend = :topleft,
    xaxis = (L&quot;θ&quot;, (0,θmax), 0:θmax),
    yaxis = (ylabel, (1,θmax), 1:θmax),
    annotate = (3.1, 3.6, latexstring(&quot;c = $c&quot;), :left),
)
scatter!(θlist, σgrid[:,1], marker=:square, color=colors[1], label = labels[1])
scatter!(θlist, σgrid[:,2], marker=:circle, color=colors[2], label = labels[2])
plot!(θlist, θlist * p_obs, label=L&quot;p \; θ&quot;, color=:black, linewidth=2,
    annotate = (3.1, 3.3, latexstring(&quot;p = $p_obs&quot;), :left))</code></pre><img src="7511e0ef.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><p>u1 plot</p><pre><code class="language-julia hljs">ubg(θ) = (θ &gt; c4) ? 1 - c * (1 + θ^2) / (θ^2 * (θ^2 + c)) : 0
utheory = ubg.(θmod)
ylabel = latexstring(&quot;\$|⟨\\hat{$(bm(:u))}, $(bm(:u))⟩|^2\$ (Avg)&quot;)
pu = plot(θfine, utheory, color=:blue, label=&quot;theory&quot;,
    left_margin = 10px, legend = :bottomright,
    xaxis = (L&quot;θ&quot;, (0,θmax), 0:θmax),
    yaxis = (ylabel, (0,1), 0:0.5:1),
)
scatter!(θlist, ugrid[:,1], marker=:square, color=colors[1], label = labels[1])
scatter!(θlist, ugrid[:,2], marker=:circle, color=colors[2], label = labels[2])</code></pre><img src="f5fde821.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><p>v1 plot</p><pre><code class="language-julia hljs">vbg(θ) = (θ &gt; c^0.25) ? 1 - (c + θ^2) / (θ^2 * (θ^2 + 1)) : 0
vtheory = vbg.(θmod)
ylabel = latexstring(&quot;\$|⟨\\hat{$(bm(:v))}, $(bm(:v))⟩|^2\$ (Avg)&quot;)
pv = plot(θfine, vtheory, color=:blue, label=&quot;theory&quot;,
    left_margin = 10px, legend = :bottomright,
    xaxis = (L&quot;θ&quot;, (0,θmax), 0:θmax),
    yaxis = (ylabel, (0,1), 0:0.5:1),
)
scatter!(θlist, vgrid[:,1], marker=:square, color=colors[1], label = labels[1])
scatter!(θlist, vgrid[:,2], marker=:circle, color=colors[2], label = labels[2])</code></pre><img src="b03ea91e.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()


if false
 savefig(ps, &quot;complete1-s.pdf&quot;)
 savefig(pu, &quot;complete1-u.pdf&quot;)
 savefig(pv, &quot;complete1-v.pdf&quot;)
 pp = plot(ps, pu, pv; layout=(3,1), size=(600, 900))
end</code></pre><h2 id="Image-example"><a class="docs-heading-anchor" href="#Image-example">Image example</a><a id="Image-example-1"></a><a class="docs-heading-anchor-permalink" href="#Image-example" title="Permalink"></a></h2><p>Apply an SVD-based matrix completion approach to some noisy and incomplete image data.</p><h2 id="Latent-matrix"><a class="docs-heading-anchor" href="#Latent-matrix">Latent matrix</a><a id="Latent-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Latent-matrix" title="Permalink"></a></h2><p>Make a matrix that has low rank:</p><pre><code class="language-julia hljs">tmp = [
    zeros(1,20);
    0 1 0 0 0 0 1 0 0 0 1 1 1 1 0 1 1 1 1 0;
    0 1 0 0 0 0 1 0 0 0 0 1 0 0 1 0 0 1 0 0;
    0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 1 0 0;
    0 0 1 1 1 1 0 0 0 0 1 1 0 0 0 0 0 1 1 0;
    zeros(1,20)
]&#39;;
rank(tmp)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4</code></pre><p>Turn it into an image:</p><pre><code class="language-julia hljs">Xtrue = kron(10 .+ 80*tmp, ones(9,9))
rtrue = rank(Xtrue)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5</code></pre><p>plots with consistent size</p><pre><code class="language-julia hljs">jim1 = (X ; kwargs...) -&gt; jim(X; size = (700,300),
 leftmargin = 10px, rightmargin = 10px, kwargs...);</code></pre><p>and consistent display range</p><pre><code class="language-julia hljs">jimc = (X ; kwargs...) -&gt; jim1(X; clim=(0,99), kwargs...);</code></pre><p>and with NRMSE label</p><pre><code class="language-julia hljs">nrmse = (Xh) -&gt; round(norm(Xh - Xtrue) / norm(Xtrue) * 100, digits=1)
args = (xaxis = false, yaxis = false, colorbar = :none) # book
args = (;) # web
jime = (X; kwargs...) -&gt; jimc(X; xlabel = &quot;NRMSE = $(nrmse(X)) %&quot;,
 args..., kwargs...,
)
title = latexstring(&quot;\$$(bm(:X))\$ : Latent image&quot;)
pt = jimc(Xtrue; title, xlabel = &quot; &quot;, args...)</code></pre><img src="a2bd08c9.svg" alt="Example block output"/><h2 id="Noisy-/-incomplete-data"><a class="docs-heading-anchor" href="#Noisy-/-incomplete-data">Noisy / incomplete data</a><a id="Noisy-/-incomplete-data-1"></a><a class="docs-heading-anchor-permalink" href="#Noisy-/-incomplete-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">seed!(0)
p_see = 0.8
mask = rand(Float32, size(Xtrue)) .&lt;= p_see
sigZ = 6
Mx,Nx = sort(collect(size(Xtrue)))
Z = sigZ * randn(size(Xtrue)) # AWGN
Y = mask .* (Xtrue + Z);

title = latexstring(&quot;\$$(bm(:Y))\$ : Corrupted image matrix\n(missing pixels set to 0)&quot;)
py = jime(Y ; title)</code></pre><img src="6a98013e.svg" alt="Example block output"/><p>Show mask; count proportion of missing entries</p><pre><code class="language-julia hljs">frac_nonzero = count(mask) / length(mask)
title = latexstring(&quot;\$$(bm(:M))\$ : Locations of observed entries&quot;)
pm = jim1(mask; title, args...,
    xlabel = &quot;sampled fraction = $(round(frac_nonzero * 100, digits=1))%&quot;)</code></pre><img src="6a7b5a05.svg" alt="Example block output"/><h2 id="Singular-values."><a class="docs-heading-anchor" href="#Singular-values.">Singular values.</a><a id="Singular-values.-1"></a><a class="docs-heading-anchor-permalink" href="#Singular-values." title="Permalink"></a></h2><p>The first 3 singular values of <span>$Y$</span> are well above the &quot;noise floor&quot; caused by masking, but, relative to those of <span>$X$</span> they are scaled down by a factor of <span>$p$</span> as expected.</p><p>We also show the critical value of <span>$σ$</span> where the phase transition occurs. <span>$σ₄(X)$</span> is just barely above the threshold, and <span>$σ₅(X)$</span> below the threshold, so we cannot expect a simple SVD approach to recover them.</p><pre><code class="language-julia hljs">c_4 = (Mx / Nx)^(1/4)
σcrit = sigZ^2 * sqrt(Nx) * c_4 / sqrt(p_see) # from RMT

pg = plot([1, Nx], [1, 1] * σcrit, color=:cyan,
 title=&quot;singular values&quot;,
 xaxis=(L&quot;k&quot;, (1, Mx), [1, 3, 6, Mx]),
 yaxis=(L&quot;σ_k&quot;,),
 leftmargin = 15px, bottommargin = 20px, size = (600,350), widen = true,
)
sv_x = svdvals(Xtrue)
sv_y = svdvals(Y)
scatter!(pg, sv_x, color=:blue, label=&quot;Xtrue&quot;, marker=:utriangle)
scatter!(pg, sv_y, color=:red, label=&quot;Y (data)&quot;, marker=:dtriangle)
scatter!(pg, sv_y[1:3] / p_see, color=:green, label=&quot;Y/p&quot;, marker=:hex, alpha=0.8)</code></pre><img src="1684a0d6.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><h2 id="Low-rank-estimate"><a class="docs-heading-anchor" href="#Low-rank-estimate">Low-rank estimate</a><a id="Low-rank-estimate-1"></a><a class="docs-heading-anchor-permalink" href="#Low-rank-estimate" title="Permalink"></a></h2><p>A simple low-rank estimate of <span>$X$</span> from the first few SVD components of <span>$Y$</span> works just so-so here. A simple SVD approach recovers the first 3 components well, but cannot estimate the 4th and 5th components.</p><pre><code class="language-julia hljs">r = 3
U,s,V = svd(Y)
s ./= p_see # correction for masking effect
Xr = U[:,1:r] * Diagonal(s[1:r]) * V[:,1:r]&#39;
title = latexstring(&quot;Rank $r approximation of data \$$(bm(:Y))\$&quot;)
pr = jime(Xr ; title)</code></pre><img src="ed624649.svg" alt="Example block output"/><p>How well do the singular vectors match? The first 3 components match quite well:</p><pre><code class="language-julia hljs">[sum(svd(Xr).U[:,1:r] .* svd(Xtrue).U[:,1:r], dims=1).^2;
 sum(svd(Xr).V[:,1:r] .* svd(Xtrue).V[:,1:r], dims=1).^2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×3 Matrix{Float64}:
 0.989971  0.933669  0.932252
 0.995877  0.967441  0.959262</code></pre><p>The next 2 components match very poorly, as predicted:</p><pre><code class="language-julia hljs">[sum(svd(Y).U[:,4:5]/p_see .* svd(Xtrue).U[:,4:5], dims=1).^2;
 sum(svd(Y).V[:,4:5]/p_see .* svd(Xtrue).V[:,4:5], dims=1).^2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
 0.014361   0.0215999
 0.0246448  0.0213955</code></pre><h3 id="Reproducibility"><a class="docs-heading-anchor" href="#Reproducibility">Reproducibility</a><a id="Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducibility" title="Permalink"></a></h3><p>This page was generated with the following version of Julia:</p><pre><code class="language-julia hljs">using InteractiveUtils: versioninfo
io = IOBuffer(); versioninfo(io); split(String(take!(io)), &#39;\n&#39;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{SubString{String}}:
 &quot;Julia Version 1.11.6&quot;
 &quot;Commit 9615af0f269 (2025-07-09 12:58 UTC)&quot;
 &quot;Build Info:&quot;
 &quot;  Official https://julialang.org/ release&quot;
 &quot;Platform Info:&quot;
 &quot;  OS: Linux (x86_64-linux-gnu)&quot;
 &quot;  CPU: 4 × AMD EPYC 7763 64-Core Processor&quot;
 &quot;  WORD_SIZE: 64&quot;
 &quot;  LLVM: libLLVM-16.0.6 (ORCJIT, znver3)&quot;
 &quot;Threads: 1 default, 0 interactive, 1 GC (on 4 virtual cores)&quot;
 &quot;&quot;</code></pre><p>And with the following package versions</p><pre><code class="language-julia hljs">import Pkg; Pkg.status()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1">Status</span></span> `~/work/book-la-demo/book-la-demo/docs/Project.toml`
  <span class="sgr90">[6e4b80f9] </span>BenchmarkTools v1.6.0
  <span class="sgr90">[aaaa29a8] </span>Clustering v0.15.8
  <span class="sgr90">[35d6a980] </span>ColorSchemes v3.30.0
<span class="sgr33">⌅</span> <span class="sgr90">[3da002f7] </span>ColorTypes v0.11.5
<span class="sgr32">⌃</span> <span class="sgr90">[c3611d14] </span>ColorVectorSpace v0.10.0
  <span class="sgr90">[717857b8] </span>DSP v0.8.4
  <span class="sgr90">[72c85766] </span>Demos v0.1.0 `~/work/book-la-demo/book-la-demo`
  <span class="sgr90">[e30172f5] </span>Documenter v1.14.1
  <span class="sgr90">[4f61f5a4] </span>FFTViews v0.3.2
  <span class="sgr90">[7a1cc6ca] </span>FFTW v1.9.0
  <span class="sgr90">[587475ba] </span>Flux v0.16.5
  <span class="sgr90">[a09fc81d] </span>ImageCore v0.10.5
  <span class="sgr90">[71a99df6] </span>ImagePhantoms v0.8.1
  <span class="sgr90">[b964fa9f] </span>LaTeXStrings v1.4.0
  <span class="sgr90">[7031d0ef] </span>LazyGrids v1.1.0
  <span class="sgr90">[599c1a8e] </span>LinearMapsAA v0.12.0
  <span class="sgr90">[98b081ad] </span>Literate v2.20.1
  <span class="sgr90">[7035ae7a] </span>MIRT v0.18.2
  <span class="sgr90">[170b2178] </span>MIRTjim v0.25.0
  <span class="sgr90">[eb30cadb] </span>MLDatasets v0.7.18
  <span class="sgr90">[efe261a4] </span>NFFT v0.13.7
  <span class="sgr90">[6ef6ca0d] </span>NMF v1.0.3
  <span class="sgr90">[15e1cf62] </span>NPZ v0.4.3
  <span class="sgr90">[0b1bfda6] </span>OneHotArrays v0.2.10
  <span class="sgr90">[429524aa] </span>Optim v1.13.2
  <span class="sgr90">[91a5bcdd] </span>Plots v1.40.19
  <span class="sgr90">[f27b6e38] </span>Polynomials v4.1.0
  <span class="sgr90">[2913bbd2] </span>StatsBase v0.34.6
  <span class="sgr90">[d6d074c3] </span>VideoIO v1.3.0
  <span class="sgr90">[b77e0a4c] </span>InteractiveUtils v1.11.0
  <span class="sgr90">[37e2e46d] </span>LinearAlgebra v1.11.0
  <span class="sgr90">[44cfe95a] </span>Pkg v1.11.0
  <span class="sgr90">[9a3f8284] </span>Random v1.11.0
<span class="sgr36"><span class="sgr1">Info</span></span> Packages marked with <span class="sgr32">⌃</span> and <span class="sgr33">⌅</span> have new versions available. Those with <span class="sgr32">⌃</span> may be upgradable, but those with <span class="sgr33">⌅</span> are restricted by compatibility constraints from upgrading. To see why use `status --outdated`</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../11/ring3/">« Classification with MLP</a><a class="docs-footer-nextpage" href="../gauss1/">Random matrix theory and rank-1 signal + noise »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 30 August 2025 19:29">Saturday 30 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
